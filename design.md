# 匿名投票系统设计文档

## 系统架构

该系统采用分层架构设计，支持异步并发处理，主要包括以下几个组件：

1. **前端应用**：
   - 提供用户界面用于投票和查看结果
   - 与后端API进行异步交互

2. **混合网络层 (Mix Network)**：
   - 实现投票请求的匿名转发
   - 打乱投票请求的时间和顺序
   - 防止投票信息与用户身份关联

3. **后端服务**：
   - 异步处理用户请求和投票逻辑
   - 异步生成和验证零知识证明
   - 与智能合约异步交互

4. **消息队列**：
   - 管理耗时任务（如ZKP证明生成）
   - 实现任务的异步处理和负载均衡

5. **智能合约**：
   - 部署在区块链上
   - 存储投票状态和结果
   - 验证投票证明的有效性

6. **ZKP电路**：
   - 定义投票逻辑的约束条件
   - 用于生成和验证零知识证明

## 核心功能模块

### 1. 用户注册与身份验证模块
- 为每个投票者生成唯一的身份标识
- 确保每个身份只能参与一次投票
- 异步处理注册请求，提高并发性能

### 2. 投票生成模块
- 使用ZKP电路生成投票证明
- 确保投票内容的隐私性（验证者无法知道具体投票值）
- 异步生成证明，避免阻塞用户请求
- 通过消息队列管理证明生成任务

### 3. 投票验证模块
- 异步验证投票证明的有效性（投票是否有效）
- 检查投票者是否已参与过投票
- 验证者无法得知投票者的具体选择

### 4. 计票模块
- 异步统计各选项的得票数
- 保证计票过程的正确性
- 支持实时更新投票结果

### 5. 结果公示模块
- 异步公开最终投票结果
- 提供结果验证接口
- 支持实时结果查询